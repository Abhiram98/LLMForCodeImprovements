{
    "Method_Improvements": {
        "Improvements": [{
            "Improvement": "Eliminate repetitive code",
            "Change_Diff": "- page=page.getAnchorByName(\"b\").click();\n  assertEquals(2,history.getLength());\n  assertEquals(1,history.getIndex());\n  assertEquals(urlB,page.getUrl());\n...\n+ navigateAndVerify(page, \"b\", 2, 1, urlB, history);\n...",
            "Description": "The same pattern of code is being repeated multiple times. You are doing the same operation of clicking a page anchor, checking the length and index of history, and validating the URL of the page. You can abstract this into a separate function to make the code cleaner and more maintainable.",
            "Start": 12,
            "End": 63
        }],
        "Final code": "/** \n * @throws Exception if an error occurs\n */\n@Test public void go() throws Exception {\n  final WebClient client=getWebClient();\n  final TopLevelWindow window=(TopLevelWindow)client.getCurrentWindow();\n  final History history=window.getHistory();\n  final String urlA=URL_FIRST + \"HistoryTest_a.html\";\n  final String urlB=URL_FIRST + \"HistoryTest_b.html\";\n  final String urlBX=URL_FIRST + \"HistoryTest_b.html#x\";\n  final String urlC=URL_FIRST + \"HistoryTest_c.html\";\n  HtmlPage page=client.getPage(urlA);\n  page = navigateAndVerify(page, \"b\", 2, 1, urlB, history);\n  page = navigateAndVerify(page, \"x\", 3, 2, urlBX, history);\n  page = navigateAndVerify(page, \"minusTwo\", 3, 0, urlA, history);\n  page = navigateAndVerify(page, \"plusOne\", 3, 1, urlB, history);\n  page = navigateAndVerify(page, \"c\", 3, 2, urlC, history);\n  page = navigateAndVerify(page, \"minusOne\", 3, 1, urlB, history);\n  page = navigateAndVerify(page, \"plusTwo\", 3, 1, urlB, history);\n}\n\nprivate HtmlPage navigateAndVerify(HtmlPage page, String anchor, int expectedHistoryLength, int expectedHistoryIndex, String expectedUrl, History history) throws Exception {\n  page = page.getAnchorByName(anchor).click();\n  assertEquals(expectedHistoryLength, history.getLength());\n  assertEquals(expectedHistoryIndex, history.getIndex());\n  assertEquals(expectedUrl, page.getUrl());\n  return page;\n}"
    },
    "Old_Method": "/** \n * @throws Exception if an error occurs\n */\n@Test public void go() throws Exception {\n  final WebClient client=getWebClient();\n  final TopLevelWindow window=(TopLevelWindow)client.getCurrentWindow();\n  final History history=window.getHistory();\n  final String urlA=URL_FIRST + \"HistoryTest_a.html\";\n  final String urlB=URL_FIRST + \"HistoryTest_b.html\";\n  final String urlBX=URL_FIRST + \"HistoryTest_b.html#x\";\n  final String urlC=URL_FIRST + \"HistoryTest_c.html\";\n  HtmlPage page=client.getPage(urlA);\n  assertEquals(1,history.getLength());\n  assertEquals(0,history.getIndex());\n  assertEquals(urlA,page.getUrl());\n  page=page.getAnchorByName(\"b\").click();\n  assertEquals(2,history.getLength());\n  assertEquals(1,history.getIndex());\n  assertEquals(urlB,page.getUrl());\n  page=page.getAnchorByName(\"x\").click();\n  assertEquals(3,history.getLength());\n  assertEquals(2,history.getIndex());\n  assertEquals(urlBX,page.getUrl());\n  page=page.getAnchorByName(\"minusTwo\").click();\n  assertEquals(3,history.getLength());\n  assertEquals(0,history.getIndex());\n  assertEquals(urlA,page.getUrl());\n  page=page.getAnchorByName(\"plusOne\").click();\n  assertEquals(3,history.getLength());\n  assertEquals(1,history.getIndex());\n  assertEquals(urlB,page.getUrl());\n  page=page.getAnchorByName(\"c\").click();\n  assertEquals(3,history.getLength());\n  assertEquals(2,history.getIndex());\n  assertEquals(urlC,page.getUrl());\n  page=page.getAnchorByName(\"minusOne\").click();\n  assertEquals(3,history.getLength());\n  assertEquals(1,history.getIndex());\n  assertEquals(urlB,page.getUrl());\n  page=page.getAnchorByName(\"plusTwo\").click();\n  assertEquals(3,history.getLength());\n  assertEquals(1,history.getIndex());\n  assertEquals(urlB,page.getUrl());\n}\n",
    "File_Path": "htmlunit/src/test/java/org/htmlunit/javascript/host/HistoryTest.java",
    "Start": 3595,
    "Stop": 5645,
    "Project_Name": "data/projects/htmlunit",
    "Method_Name": "go"
}